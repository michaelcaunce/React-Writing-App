(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[3],{

/***/ "./app/components/ViewSinglePost.js":
/*!******************************************!*\
  !*** ./app/components/ViewSinglePost.js ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _Page__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Page */ \"./app/components/Page.js\");\n/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-router-dom */ \"./node_modules/react-router-dom/esm/react-router-dom.js\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! axios */ \"./node_modules/axios/index.js\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var react_markdown__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react-markdown */ \"./node_modules/react-markdown/lib/react-markdown.js\");\n/* harmony import */ var react_markdown__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react_markdown__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var react_tooltip__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-tooltip */ \"./node_modules/react-tooltip/dist/index.es.js\");\n/* harmony import */ var _LoadingDotsIcon__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./LoadingDotsIcon */ \"./app/components/LoadingDotsIcon.js\");\n/* harmony import */ var _NotFound__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./NotFound */ \"./app/components/NotFound.js\");\n/* harmony import */ var _StateContext__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../StateContext */ \"./app/StateContext.js\");\n/* harmony import */ var _DispatchContext__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../DispatchContext */ \"./app/DispatchContext.js\");\n\n\n\n\n\n\n\n\n\n\n\nfunction ViewSinglePost(props) {\n  const appState = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useContext\"])(_StateContext__WEBPACK_IMPORTED_MODULE_8__[\"default\"]);\n  const appDispatch = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useContext\"])(_DispatchContext__WEBPACK_IMPORTED_MODULE_9__[\"default\"]);\n  const {\n    id\n  } = Object(react_router_dom__WEBPACK_IMPORTED_MODULE_2__[\"useParams\"])();\n  const [isLoading, setIsLoading] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(true);\n  const [post, setPost] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(); // Send request to the backend\n\n  Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useEffect\"])(() => {\n    const ourRequest = axios__WEBPACK_IMPORTED_MODULE_3___default.a.CancelToken.source();\n\n    async function fetchPost() {\n      try {\n        const response = await axios__WEBPACK_IMPORTED_MODULE_3___default.a.get(`/post/${id}`, {\n          cancelToken: ourRequest.token\n        }); // Store the value in state\n\n        setPost(response.data); // Set is loading to false to display all posts\n\n        setIsLoading(false);\n      } catch (e) {\n        console.log(\"There was an error or the request was cancelled\");\n      }\n    }\n\n    fetchPost(); // Function to run when this component stops being rendered.\n\n    return () => {\n      ourRequest.cancel();\n    };\n  }, [id]);\n\n  if (!isLoading && !post) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_Page__WEBPACK_IMPORTED_MODULE_1__[\"default\"], {\n      title: \"Not Found\"\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"text-center content-container\"\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"h2\", null, \"We cannot find this page\"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"p\", {\n      className: \"lead text-muted\"\n    }, \"Please return to the \", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_2__[\"Link\"], {\n      to: \"/\"\n    }, \"Homepage\"))));\n  }\n\n  if (isLoading) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_Page__WEBPACK_IMPORTED_MODULE_1__[\"default\"], {\n    title: \"...\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_LoadingDotsIcon__WEBPACK_IMPORTED_MODULE_6__[\"default\"], null));\n  const date = new Date(post.createdDate);\n  const dateFormatted = `${date.getDate()}/${date.getMonth() + 1}/${date.getFullYear()}`; // Function to determine if the post matches the author\n\n  function isOwner() {\n    if (appState.loggedIn) {\n      return appState.user.username == post.author.username;\n    }\n\n    return false;\n  }\n\n  async function deleteHandler() {\n    const areYouSure = window.confirm(\"Do you really want to delete this post?\");\n\n    if (areYouSure) {\n      try {\n        const response = await axios__WEBPACK_IMPORTED_MODULE_3___default.a.delete(`/post/${id}`, {\n          data: {\n            token: appState.user.token\n          }\n        });\n\n        if (response.data == \"Success\") {\n          // 1. display a flash message\n          appDispatch({\n            type: \"flashMessage\",\n            value: \"Post was successfully deleted.\"\n          }); // 2. redirect back to the current user's profile\n\n          props.history.push(`/profile/${appState.user.username}`);\n        }\n      } catch (e) {\n        console.log(\"There was a problem.\");\n      }\n    }\n  }\n\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_Page__WEBPACK_IMPORTED_MODULE_1__[\"default\"], {\n    title: post.title\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    className: \"content-container\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    className: \"d-flex justify-content-between\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"h2\", null, post.title), isOwner() && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n    className: \"pt-2\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_2__[\"Link\"], {\n    to: `/post/${post._id}/edit`,\n    \"data-tip\": \"Edit\",\n    \"data-for\": \"edit\",\n    className: \"text-primary mr-2\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"i\", {\n    className: \"fas fa-edit\"\n  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_tooltip__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n    id: \"edit\",\n    className: \"custom-tooltip\"\n  }), \" \", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"a\", {\n    onClick: deleteHandler,\n    \"data-tip\": \"Delete\",\n    \"data-for\": \"delete\",\n    className: \"delete-post-button text-danger\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"i\", {\n    className: \"fas fa-trash\"\n  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_tooltip__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n    id: \"delete\",\n    className: \"custom-tooltip\"\n  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"p\", {\n    className: \"text-muted small mb-4\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_2__[\"Link\"], {\n    to: `/profile/${post.author.username}`\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"img\", {\n    className: \"avatar-tiny\",\n    src: post.author.avatar\n  })), \"Posted by \", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_2__[\"Link\"], {\n    to: `/profile/${post.author.username}`\n  }, post.author.username), \" on \", dateFormatted), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    className: \"body-content\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_markdown__WEBPACK_IMPORTED_MODULE_4___default.a, {\n    source: post.body,\n    allowedTypes: [\"paragraph\", \"strong\", \"emphasis\", \"text\", \"heading\", \"list\", \"listItem\", \"image\", \"blockquote\"]\n  }))));\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Object(react_router_dom__WEBPACK_IMPORTED_MODULE_2__[\"withRouter\"])(ViewSinglePost));\n\n//# sourceURL=webpack:///./app/components/ViewSinglePost.js?");

/***/ })

}]);